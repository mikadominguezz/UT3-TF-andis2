
    var m = Array(256), 
        acc = 0,
        brs = 0,
        cnt = 0,
        r = Array(256),
        gnt = 0,
        isd = false;


    function reset() {
        acc = brs = cnt = 0;
        for (var i = 0; i < 256; ++i)
            m[i] = r[i] = 0;
        gnt = 0;
    }

        function seed_mix() {
            a ^= b <<  11; d = add(d, a); b = add(b, c);
            b ^= c >>>  2; e = add(e, b); c = add(c, d);
            c ^= d <<   8; f = add(f, c); d = add(d, e);
            d ^= e >>> 16; g = add(g, d); e = add(e, f);
            e ^= f <<  10; h = add(h, e); f = add(f, g);
            f ^= g >>>  4; a = add(a, f); g = add(g, h);
            g ^= h <<   8; b = add(b, g); h = add(h, a);
            h ^= a >>>  9; c = add(c, h); a = add(a, b);
        }

                a = add(a, r[i + 0]), b = add(b, r[i + 1]),
                c = add(c, r[i + 2]), d = add(d, r[i + 3]),
                e = add(e, r[i + 4]), f = add(f, r[i + 5]),
                g = add(g, r[i + 6]), h = add(h, r[i + 7]);
            seed_mix();
            for (i = 0; i < 256; i += 8)
                a = add(a, m[i + 0]), b = add(b, m[i + 1]),
                c = add(c, m[i + 2]), d = add(d, m[i + 3]),
                e = add(e, m[i + 4]), f = add(f, m[i + 5]),
                g = add(g, m[i + 6]), h = add(h, m[i + 7]),
                seed_mix(),
    function prng(n) {
        var i, x, y;
        n = n && typeof(n) === 'number' ? Math.abs(Math.floor(n)) : 1;
        while (n--) {
            cnt = add(cnt,   1);
            brs = add(brs, cnt);
            for(i = 0; i < 256; i++) {
                switch(i & 3) {
                    case 0: acc ^= acc <<  13; break;
                    case 1: acc ^= acc >>>  6; break;
                    case 2: acc ^= acc <<   2; break;
                    case 3: acc ^= acc >>> 16; break;
                }
                acc        = add(m[(i +  128) & 0xff], acc); x = m[i];
                m[i] =   y = add(m[(x >>>  2) & 0xff], add(acc, brs));
                r[i] = brs = add(m[(y >>> 10) & 0xff], x);
            }
        }
    }
